<!DOCTYPE html>
<html
  lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://thymeleaf.org"
>
  <head>
    <meta charset="UTF-8" />
    <object th:insert="~{fragments/common :: css}" th:remove="tag"></object>
    <object th:insert="~{fragments/common :: js}" th:remove="tag"></object>
    <title>Profile</title>
  </head>

  <body>
    <div th:replace="~{fragments/alert :: alert}"></div>
    <div class="flex justify-end min-h-screen">
      <div
        class="w-[20%] py-10 bg-gray-100 flex flex-col justify-between items-center top-0 left-0 min-h-screen"
      >
        <div>
          <a
            th:href="@{/}"
            class="flex items-center justify-center group mb-10"
          >
            <img
              th:src="@{/images/apapedia-logo.png}"
              class="h-8 mr-3"
              alt="Apapedia Logo"
            />
            <span
              class="self-center text-2xl text-slate-800 font-semibold whitespace-nowrap group-hover:text-blue-500"
              >Apapedia</span
            >
          </a>
          <div class="px-10 flex flex-col items-center">
            <div class="w-full rounded-lg p-5 shadow-md bg-white">
              <p class="font-medium text-slate-700 text-center">Apapay</p>
              <hr class="border-b-1 border-gray-400 my-2" />
              <p
                class="text-center text-slate-800 font-bold text-lg"
                th:text="${profile.balance == 0 ? 'Rp 0' : 'Rp ' + ${#numbers.formatDecimal(profile.balance, 0, 'COMMA', 2, 'POINT')}}""
              ></p>
              <a
                th:href="@{/profile/withdraw}"
                type="button"
                class="text-white bg-gradient-to-br from-purple-600 to-blue-500 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2 text-center mt-5"
              >
                Withdraw
              </a>
            </div>
          </div>
        </div>

        <div class="w-full px-10 flex flex-col gap-5">
          <a
            href="/logout-sso"
            type="button"
            class="flex justify-center font-medium items-center text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-pink-200 font-medium rounded-lg text-sm px-5 py-2 text-center"
            ><span
              ><svg
                class="w-4 h-4 mr-3 text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 18 15"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M1 7.5h11m0 0L8 3.786M12 7.5l-4 3.714M12 1h3c.53 0 1.04.196 1.414.544.375.348.586.82.586 1.313v9.286c0 .492-.21.965-.586 1.313A2.081 2.081 0 0 1 15 14h-3"
                /></svg></span
            >Sign Out</a
          >
          <a
            th:href="@{/profile/delete-account}"
            type="button"
            class="flex justify-center font-medium items-center text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-pink-200 font-medium rounded-lg text-sm px-5 py-2 text-center"
            ><span
              ><svg
                class="w-4 h-4 mr-3 text-white"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 20 20"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
                /></svg></span
            >Delete Account</a
          >
        </div>
      </div>
      <div
        class="w-[80%] px-10 py-10 flex flex-col justify-center items-center"
      >
        <div class="bg-white rounded-xl shadow-lg w-[80%] p-10">
          <div class="flex justify-between">
            <h4 class="font-bold text-gray-800 text-xl flex items-center">
              <svg
                class="w-6 h-6 mr-3"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 14 18"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 8a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm-2 3h4a4 4 0 0 1 4 4v2H1v-2a4 4 0 0 1 4-4Z"
                />
              </svg>
              My Profile
            </h4>
            <div class="flex">
              <div
                th:if="${profile.category == 'Basic'}"
                class="rounded-full flex items-center text-white bg-green-700 font-medium text-sm px-5 py-2 text-center"
              >
                Basic
              </div>
              <div
                th:unless="${profile.category == 'Basic'}"
                class="rounded-full flex items-center text-white bg-gradient-to-br from-purple-600 to-blue-500 font-medium text-sm px-3 py-2 text-center ml-3"
              >
                <svg
                  class="w-5 h-5 text-white mr-2"
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 21 21"
                >
                  <path
                    stroke="currentColor"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="m6.072 10.072 2 2 6-4m3.586 4.314.9-.9a2 2 0 0 0 0-2.828l-.9-.9a2 2 0 0 1-.586-1.414V5.072a2 2 0 0 0-2-2H13.8a2 2 0 0 1-1.414-.586l-.9-.9a2 2 0 0 0-2.828 0l-.9.9a2 2 0 0 1-1.414.586H5.072a2 2 0 0 0-2 2v1.272a2 2 0 0 1-.586 1.414l-.9.9a2 2 0 0 0 0 2.828l.9.9a2 2 0 0 1 .586 1.414v1.272a2 2 0 0 0 2 2h1.272a2 2 0 0 1 1.414.586l.9.9a2 2 0 0 0 2.828 0l.9-.9a2 2 0 0 1 1.414-.586h1.272a2 2 0 0 0 2-2V13.8a2 2 0 0 1 .586-1.414Z"
                  />
                </svg>
                Official Store
              </div>
            </div>
          </div>
          <hr class="mt-2 mb-5 border-b-1 border-gray-200" />
          <div class="flex flex-col gap-6">
            <div>
              <p class="text-gray-400 font-medium text-sm">Name</p>
              <div class="flex justify-between">
                <p
                  class="text-base font-semibold text-slate-800"
                  th:text="${profile.name}"
                ></p>
                <button
                  class="no-underline font-bold text-sm text-gray-400 hover:text-gray-500"
                  onclick="showModal('Name');"
                >
                  CHANGE
                </button>
              </div>
              <hr class="mt-2" />
            </div>
            <div>
              <p class="text-gray-400 font-medium text-sm">Username</p>
              <div class="flex justify-start">
                <p
                  class="text-base font-semibold text-slate-800"
                  th:text="${profile.username}"
                ></p>
              </div>
              <hr class="mt-2" />
            </div>
            <div>
              <p class="text-gray-400 font-medium text-sm">Email</p>
              <div class="flex justify-start">
                <p
                  class="text-base font-semibold text-slate-800"
                  th:text="${profile.email}"
                ></p>
              </div>
              <hr class="mt-2" />
            </div>
            <div>
              <p class="text-gray-400 font-medium text-sm">Address</p>
              <div class="flex justify-between">
                <p
                  class="text-base font-semibold text-slate-800"
                  th:text="${profile.address}"
                ></p>
                <button
                  class="no-underline font-bold text-sm text-gray-400 hover:text-gray-500"
                  onclick="showModal('Address');"
                >
                  CHANGE
                </button>
              </div>
              <hr class="mt-2" />
            </div>
            <div>
              <p class="text-gray-400 font-medium text-sm">Password</p>
              <div class="flex justify-between">
                <p class="text-base font-semibold text-slate-800">**********</p>
                <a
                  href="https://beranda.ui.ac.id/"
                  type="button"
                  class="no-underline font-bold text-sm text-gray-400 hover:text-gray-500 flex items-center group"
                >
                  <svg
                    class="w-4 h-4 text-gray-400 group-hover:text-gray-500 mr-2"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 16 20"
                  >
                    <path
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M11.5 8V4.5a3.5 3.5 0 1 0-7 0V8M8 12v3M2 8h12a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1Z"
                    />
                  </svg>
                  CHANGE
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal container -->
    <div
      id="myModal"
      class="bg-black bg-opacity-20 fixed inset-0 z-50 flex items-center justify-center hidden"
    >
      <!-- Modal -->
      <div class="bg-white p-6 rounded-xl shadow-md w-[30%]">
        <div class="flex justify-between">
          <h2 id="update-title" class="text-xl font-semibold text-gray-800">
            Edit Profile
          </h2>
          <!-- Close button -->
          <button
            id="closeModal"
            class="text-gray-600 hover:text-gray-800"
            onclick="closeModal()"
          >
            <svg
              class="w-6 h-6 text-gray-300 hover:text-gray-400"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 11.793a1 1 0 1 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 1.414-1.414L10 8.586l2.293-2.293a1 1 0 0 1 1.414 1.414L11.414 10l2.293 2.293Z"
              />
            </svg>
          </button>
        </div>
        <!-- Modal content goes here -->
        <div class="my-4">
          <form
            th:action="@{/profile/edit}"
            method="POST"
            th:object="${profileDTO}"
          >
            <input
              type="hidden"
              th:field="*{updatedAttribute}"
              th:value="none"
              id="hiddenInput"
            />
            <input
              type="text"
              th:field="*{newValue}"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
              placeholder="Insert new value.."
              required
            />
            <button
              type="submit"
              class="mt-4 text-white w-full bg-gradient-to-br from-purple-600 to-blue-500 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2.5 text-center"
            >
              Save
            </button>
          </form>
        </div>
      </div>
    </div>

    <script>
      // Get modal and close button elements
      var modal = document.getElementById("myModal");
      var closeModalBtn = document.getElementById("closeModal");
      var hiddenInput = document.getElementById("hiddenInput");

      function showModal(attribute) {
        modal.classList.remove("hidden");

        var updateTitleElement = document.getElementById("update-title");
        if (updateTitleElement) {
          updateTitleElement.textContent = "Edit " + attribute;
        }
        hiddenInput.value = attribute;
      }

      // Close modal function
      function closeModal() {
        modal.classList.add("hidden");
      }

      // Close modal on outside click
      window.addEventListener("click", function (event) {
        if (event.target === modal) {
          closeModal();
        }
      });
    </script>
  </body>
</html>
